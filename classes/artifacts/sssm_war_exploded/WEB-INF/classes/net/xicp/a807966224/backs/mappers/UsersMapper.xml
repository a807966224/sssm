<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
  "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="net.xicp.a807966224.backs.daos.UsersDao">
	
	<select id="findByUsername" resultType="net.xicp.a807966224.backs.beans.Users">
		select users.id id,users.username username,users.password password,users.state state FROM users where users.username = #{username}
	</select>
	
	<select id="findAuthsByUserid" resultType="net.xicp.a807966224.backs.beans.Authorities">
		select authorities.authname authname from users,authorities,groups
		where users.id = groups.user_id and authorities.id = groups.auth_id and users.id = #{id}
	</select>

    <select id="findMenusByUsername" resultType="net.xicp.a807966224.backs.beans.Authorities">
		select menus.id,menuname,url,parent
        from users,groups,ams,menus WHERE
        users.id = groups.user_id and groups.auth_id = ams.auth_id
        and ams.menu_id = menus.id
        and users.username = #{username} and level = #{level} and users.state = '1'
	</select>
	
	<select id="findAllUsers" resultType="net.xicp.a807966224.backs.beans.Users" >
		select id,username,state from users order by id desc
	</select>

	<insert id="insert" parameterType="net.xicp.a807966224.backs.beans.Users" >
		insert into users (username,password,state) values (#{username},#{password},#{state})
	</insert>

    <update id="update" parameterType="net.xicp.a807966224.backs.beans.Users" >
        update users set username = #{username},password = #{password},state = #{state} where id = #{id}
    </update>

    <delete id="delete" parameterType="net.xicp.a807966224.backs.beans.Users" >
        delete from users where id = #{id}
    </delete>
	
</mapper>